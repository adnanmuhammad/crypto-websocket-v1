<!DOCTYPE html>
<!-- Template Name: Clip-Two - Responsive Admin Template build with Twitter Bootstrap 3.x | Author: ClipTheme -->
<!--[if IE 8]><html class="ie8" lang="en"><![endif]-->
<!--[if IE 9]><html class="ie9" lang="en"><![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- start: HEAD -->
<head>
    <title>Market Order</title>

    <% include cores/header.ejs %>

    <div class="main-content" >
        <div class="wrap-content container" id="container" style="width: 100% !important;">
            <!-- start: DASHBOARD TITLE -->
            <section id="page-title" class="padding-top-15 padding-bottom-15" style="">
                <div class="row">
                    <div class="col-sm-7">
                        <h1 class="mainTitle" style="background-image: none !important;">Market Order</h1>
                        <span class="mainDescription">&nbsp;</span>
                    </div>
                </div>
            </section>
            <!-- end: DASHBOARD TITLE -->


            <!-- start: REGISTRATION -->
            <div class="row">
                <div class="main-login col-xs-12">
                    <!-- start: REGISTER BOX -->
                    <div class="box-register">

                        <div class="alert alert-success" role="alert" style="display: none;">
                            Market Order Placed Successfully.
                        </div>

                        <div class="alert alert-danger alert-error" role="alert" style="display: none;">
                            Something went wrong, Market order not placed.
                        </div>

                        <form class="form-register" method="POST" id="signup-form" action="/signupuser" enctype="multipart/form-data">
                            <fieldset>
                                <legend>
                                    Market Order
                                </legend>
                                <p>
                                    MARKET ORDER INPUT
                                </p>
                                <div class="form-group">
                                    <select name="market" id="market" class="form-control show-tick ms select2">
                                        <option value="USDT" selected>USDT</option>
                                        <option value="BUSD">BUSD</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <input type="text" class="form-control" name="currency" id="currency" placeholder="Type desired currency" required>
                                </div>
                                <div class="form-group">
                                    <input type="text" class="form-control" name="quantity" id="quantity" placeholder="Type quantity in Market value" required>
                                </div>
                                <div class="form-actions">
                                    <button type="button" class="btn btn-primary pull-right" id="btn-submit">
                                        Send Order <i class="fa fa-arrow-circle-right"></i>
                                    </button>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                    <!-- end: REGISTER BOX -->
                </div>
            </div>
            <!-- end: REGISTRATION -->



        </div>
    </div>

     <% include cores/footer.ejs %>

    <script>
        $('body').on('click', '#btn-submit', function() {
            $('#btn-submit').prop('disabled', true);
            var market      = $("#market").val();
            var currency    = $("#currency").val();
            var quantity    = $("#quantity").val();

            $.ajax({
                url: "http://3.236.53.56:1337/send_market_order",
                method: "POST",
                data: {market: market, currency: currency, quantity: quantity},
                success: function (response) {
                    //console.log(response);
                    result = JSON.parse(response);
                    if (result.hasOwnProperty('success')) {
                        $(".alert-success").fadeTo(2000, 1000).slideUp(1000, function() {
                            $(".alert-success").slideUp(1000);
                            window.location.href = "http://3.236.53.56:1337/market_order";
                        });
                    } else if (result.hasOwnProperty('error')) {
                        //console.log(result);
                        $(".alert-error").html(result.message);
                        $(".alert-error").fadeTo(2000, 1000).slideUp(1000, function() {
                            $(".alert-error").slideUp(1000);
                        });
                        $('#btn-submit').prop('disabled', false);
                    }
                }
            });
        });
    </script>